--------------------------------------------
SSL Switcher - readme.txt
--------------------------------------------

[機能]
MODxのリソース毎にhttpとhttpsの設定を行い、自動でURLの変換をしたり、自動リダイレクトしてくれるプラグインです。
以下の機能があります。

1.[~s(リソースID)~]タグによるURL変換
  MODxのタグに[~(リソースID)~]という表記があります。
  このタグは指定したリソースIDのファイル名に変換されます。
  SSL Swicherではこれに似た新しいタグ[~s(リソースID)~]表記が使用できます。
  ※さきっちょに「s」がついてます。

  この表記では、httpsに設定されたリソースIDを指定した際、ドメイン付きのURLに変換されます。
  変換ルールは次の通りです。

                              ↓[~s(リソースID)~]タグに書かれるリソース
  |----------------------------------------------------------------------|
  |                         | http設定のリソース  | https設定のリソース  |
  |-----------------------------------------------------------------------
  |http設定のリソース       | 通常変換            | https+ドメイン付変換 |
  |https設定のリソース      | http+ドメイン付変換 | 通常変換             |
  |----------------------------------------------------------------------|
   ↑タグが書かれるリソース

2.httpからhttpsのページの強制リダイレクト
ドキュメント内の「SwitchHTTP to HTTPS」有効にすると、そのドキュメントにhttpでアクセスしてきた場合、
強制的にhttpsのページにリダイレクトさせます。


[動作確認環境]
  ・MODx0.9.5 and 0.9.6
  ・PHP5.2.x
  ・MySQL 5.0.33
  ・文字コード UTF-8


[インストール方法]
1.アーカイブファイルを解凍します。

2.管理画面でプラグインを新規作成します。
  ※「リソース」→「リソース管理」→「プラグイン」→「プラグインの作成」

    [全般]
    プラグイン名    : sslSwitcher
    説明            : (任意)
    プラグインコード: sslSwitcher.txtファイルの中身をそのまま張りつける

    [設定]※特に設定はありません    

    [システムイベント]
    次のイベントをクリックしてチェックを付けてください。

      ・OnWebPageInit
      ・OnWebPagePrerender

3.管理画面でテンプレート変数を作成します。
  ※「リソース」→「リソース管理」→「テンプレート変数」
                                         →「テンプレート変数の作成」

    変数名               : sslSwitcher
    説明                 : (任意)
    入力タイプ           : Check Box
    入力時のオプション値 : UseHTTPS||SwitchHTTP to HTTPS
    規定値               : 空白のまま
    Widget               : 選択無
    並べ替え順           : (任意)※わからなければ0でOKです
    テンプレートへのアクセス： 
                    現在使用しているテンプレートをチェックしてください。
                    (よくわかれなければ全てにチェックでもOKです)

[使い方]
1.管理画面でhttpsを使いたいリソースを編集します。
  テンプレート変数の部分に「UseHTTPS」「SwitchHTTP to HTTPS」と書かれたチェ
  ックボックスが表示されているので、必要に応じてチェックをつけて保存します。
  
    ・UseHTTPS
      該当リソースではhttpsを使用する

    ・SwitchHTTP to HTTPS
      httpでアクセスされた場合、強制的にhttpsページに切り替える

2.ドキュメント内で[~(リソースID)~]と書く部分を以下のように書き換えます。

    [~s(リソースID)~]    ※「s」がついてます。

  これで通常は[~(リソースID)~]と同じような変換を行うのですが、httpから
  httpsのリソースに移るような場合はhttps付のURLにかわります。
  (httpsからhttpに移るときはhttp付のURLにかわります)

3.httpからhttpsページの切り替え
  「SwitchHTTP to HTTPS」を有効にしているリソースにhttpでアクセスします。
  するとhttpsのページに切り替わります。

[URL変換の例]
  [サイトのURL] http://ayd.jp/
  [httpのリソースID] 10
  [httpsのリソースID] 20

1.リソースID10で以下の書き方をした場合の変換後のURL

    [~s10~] → /index.php?q=10
    [~s20~] → https://ayd.jp/index.php?q=20

2.リソースID20で以下の書き方をした場合の変換後のURL

    [~s10~] → http://ayd.jp/index.php?q=10
    [~s20~] → /index.php?q=20
